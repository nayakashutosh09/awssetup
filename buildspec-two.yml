version: 0.2
phases:
  install:
    runtime-versions:
      nodejs: latest
  build:
    commands:
      - curl -LJ0 https://github.com/nayakashutosh09/awssetup/variables.txt
      - echo $(pwd)
      - |
        while IFS= read -r line || [ -n "$line" ]; do
          export "$line"
        done < $(pwd)/variables.txt
      - echo "REGION is" $REGION
      - |
      - if [ "$REGION" = "ZAF" ]; then
          echo "A.....";
          echo "Logging in to Amazon ECR...";
          aws --version
          echo $AWS_DEFAULT_REGION
          REPOSITORY_URI1=374898892977.dkr.ecr.us-east-1.amazonaws.com/vsr-h2o-model
          REPOSITORY_URI2=374898892977.dkr.ecr.us-east-1.amazonaws.com/vsr-pipeline
          aws sts get-caller-identity
          echo Logging in to Amazon ECR...
          curl -LJ0 https://github.com/nayakashutosh09/awssetup/pipeline-config.json
          aws s3 cp pipeline-config.json s3://ci-cd-pipeline-precision-ag/Model_Management/ZAF/
          echo $(pwd)
          docker volume create volume_precision
          mkdir -p $(pwd)/vsr/tmp
          echo ls $(pwd)/vsr/tmp
          aws s3 cp s3://ci-cd-pipeline-precision-ag/Model_Management/Mod_5.0_QC5 $(pwd)/vsr/tmp
          aws s3 cp s3://ci-cd-pipeline-precision-ag/Model_Management/ZAF/calibrateddata.csv $(pwd)/vsr/tmp
        elif [ "$REGION" = "ARG" ]; then
          echo "B.....";
        else
          echo "hey how are you";
        fi
